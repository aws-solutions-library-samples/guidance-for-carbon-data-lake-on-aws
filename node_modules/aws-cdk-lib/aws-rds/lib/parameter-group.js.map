{
  "version": 3,
  "sources": ["parameter-group.ts"],
  "sourcesContent": ["import { IResource, Lazy, Resource } from '../../core';\nimport { Construct } from 'constructs';\nimport { IEngine } from './engine';\nimport { CfnDBClusterParameterGroup, CfnDBParameterGroup } from './rds.generated';\n\n/**\n * Options for {@link IParameterGroup.bindToCluster}.\n * Empty for now, but can be extended later.\n */\nexport interface ParameterGroupClusterBindOptions {\n}\n\n/**\n * The type returned from {@link IParameterGroup.bindToCluster}.\n */\nexport interface ParameterGroupClusterConfig {\n  /** The name of this parameter group. */\n  readonly parameterGroupName: string;\n}\n\n/**\n * Options for {@link IParameterGroup.bindToInstance}.\n * Empty for now, but can be extended later.\n */\nexport interface ParameterGroupInstanceBindOptions {\n}\n\n/**\n * The type returned from {@link IParameterGroup.bindToInstance}.\n */\nexport interface ParameterGroupInstanceConfig {\n  /** The name of this parameter group. */\n  readonly parameterGroupName: string;\n}\n\n/**\n * A parameter group.\n * Represents both a cluster parameter group,\n * and an instance parameter group.\n */\nexport interface IParameterGroup extends IResource {\n  /**\n   * Method called when this Parameter Group is used when defining a database cluster.\n   */\n  bindToCluster(options: ParameterGroupClusterBindOptions): ParameterGroupClusterConfig;\n\n  /**\n   * Method called when this Parameter Group is used when defining a database instance.\n   */\n  bindToInstance(options: ParameterGroupInstanceBindOptions): ParameterGroupInstanceConfig;\n\n  /**\n   * Adds a parameter to this group.\n   * If this is an imported parameter group,\n   * this method does nothing.\n   *\n   * @returns true if the parameter was actually added\n   *   (i.e., this ParameterGroup is not imported),\n   *   false otherwise\n   */\n  addParameter(key: string, value: string): boolean;\n}\n\n/**\n * Properties for a parameter group\n */\nexport interface ParameterGroupProps {\n  /**\n   * The database engine for this parameter group.\n   */\n  readonly engine: IEngine;\n\n  /**\n   * Description for this parameter group\n   *\n   * @default a CDK generated description\n   */\n  readonly description?: string;\n\n  /**\n   * The parameters in this parameter group\n   *\n   * @default - None\n   */\n  readonly parameters?: { [key: string]: string };\n}\n\n/**\n * A parameter group.\n * Represents both a cluster parameter group,\n * and an instance parameter group.\n *\n * @resource AWS::RDS::DBParameterGroup\n */\nexport class ParameterGroup extends Resource implements IParameterGroup {\n  /**\n   * Imports a parameter group\n   */\n  public static fromParameterGroupName(scope: Construct, id: string, parameterGroupName: string): IParameterGroup {\n    class Import extends Resource implements IParameterGroup {\n      public bindToCluster(_options: ParameterGroupClusterBindOptions): ParameterGroupClusterConfig {\n        return { parameterGroupName };\n      }\n\n      public bindToInstance(_options: ParameterGroupInstanceBindOptions): ParameterGroupInstanceConfig {\n        return { parameterGroupName };\n      }\n\n      public addParameter(_key: string, _value: string): boolean {\n        return false;\n      }\n    }\n\n    return new Import(scope, id);\n  }\n\n  private readonly parameters: { [key: string]: string };\n  private readonly family: string;\n  private readonly description?: string;\n\n  private clusterCfnGroup?: CfnDBClusterParameterGroup;\n  private instanceCfnGroup?: CfnDBParameterGroup;\n\n  constructor(scope: Construct, id: string, props: ParameterGroupProps) {\n    super(scope, id);\n\n    const family = props.engine.parameterGroupFamily;\n    if (!family) {\n      throw new Error(\"ParameterGroup cannot be used with an engine that doesn't specify a version\");\n    }\n    this.family = family;\n    this.description = props.description;\n    this.parameters = props.parameters ?? {};\n  }\n\n  public bindToCluster(_options: ParameterGroupClusterBindOptions): ParameterGroupClusterConfig {\n    if (!this.clusterCfnGroup) {\n      const id = this.instanceCfnGroup ? 'ClusterParameterGroup' : 'Resource';\n      this.clusterCfnGroup = new CfnDBClusterParameterGroup(this, id, {\n        description: this.description || `Cluster parameter group for ${this.family}`,\n        family: this.family,\n        parameters: Lazy.any({ produce: () => this.parameters }),\n      });\n    }\n    return {\n      parameterGroupName: this.clusterCfnGroup.ref,\n    };\n  }\n\n  public bindToInstance(_options: ParameterGroupInstanceBindOptions): ParameterGroupInstanceConfig {\n    if (!this.instanceCfnGroup) {\n      const id = this.clusterCfnGroup ? 'InstanceParameterGroup' : 'Resource';\n      this.instanceCfnGroup = new CfnDBParameterGroup(this, id, {\n        description: this.description || `Parameter group for ${this.family}`,\n        family: this.family,\n        parameters: Lazy.any({ produce: () => this.parameters }),\n      });\n    }\n    return {\n      parameterGroupName: this.instanceCfnGroup.ref,\n    };\n  }\n\n  /**\n   * Add a parameter to this parameter group\n   *\n   * @param key The key of the parameter to be added\n   * @param value The value of the parameter to be added\n   */\n  public addParameter(key: string, value: string): boolean {\n    this.parameters[key] = value;\n    return true;\n  }\n}\n"],
  "mappings": "qNAAA,OAAA,QAAA,cAGA,gBAAA,QAAA,mBA2FA,4BAAoC,QAAA,QAAQ,CA6B1C,YAAY,MAAkB,GAAY,MAA0B,QAClE,MAAM,MAAO,2EAEb,KAAM,QAAS,MAAM,OAAO,qBAC5B,GAAI,CAAC,OACH,KAAM,IAAI,OAAM,+EAElB,KAAK,OAAS,OACd,KAAK,YAAc,MAAM,YACzB,KAAK,WAAU,IAAG,MAAM,cAAU,MAAA,KAAA,OAAA,GAAI,SAlC1B,wBAAuB,MAAkB,GAAY,mBAA0B,CAC3F,oBAAqB,QAAA,QAAQ,CACpB,cAAc,SAA0C,CAC7D,MAAO,CAAE,oBAGJ,eAAe,SAA2C,CAC/D,MAAO,CAAE,oBAGJ,aAAa,KAAc,OAAc,CAC9C,MAAO,IAIX,MAAO,IAAI,QAAO,MAAO,IAsBpB,cAAc,SAA0C,CAC7D,0FAAI,CAAC,KAAK,gBAAiB,CACzB,KAAM,IAAK,KAAK,iBAAmB,wBAA0B,WAC7D,KAAK,gBAAkB,GAAI,iBAAA,2BAA2B,KAAM,GAAI,CAC9D,YAAa,KAAK,aAAe,+BAA+B,KAAK,SACrE,OAAQ,KAAK,OACb,WAAY,OAAA,KAAK,IAAI,CAAE,QAAS,IAAM,KAAK,eAG/C,MAAO,CACL,mBAAoB,KAAK,gBAAgB,KAItC,eAAe,SAA2C,CAC/D,2FAAI,CAAC,KAAK,iBAAkB,CAC1B,KAAM,IAAK,KAAK,gBAAkB,yBAA2B,WAC7D,KAAK,iBAAmB,GAAI,iBAAA,oBAAoB,KAAM,GAAI,CACxD,YAAa,KAAK,aAAe,uBAAuB,KAAK,SAC7D,OAAQ,KAAK,OACb,WAAY,OAAA,KAAK,IAAI,CAAE,QAAS,IAAM,KAAK,eAG/C,MAAO,CACL,mBAAoB,KAAK,iBAAiB,KAUvC,aAAa,IAAa,MAAa,CAC5C,YAAK,WAAW,KAAO,MAChB,IA7EX,QAAA,eAAA",
  "names": []
}
