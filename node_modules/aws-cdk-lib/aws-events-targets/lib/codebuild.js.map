{
  "version": 3,
  "sources": ["codebuild.ts"],
  "sourcesContent": ["import * as codebuild from '../../aws-codebuild';\nimport * as events from '../../aws-events';\nimport * as iam from '../../aws-iam';\nimport { addToDeadLetterQueueResourcePolicy, bindBaseTargetConfig, singletonEventRole, TargetBaseProps } from './util';\n\n/**\n * Customize the CodeBuild Event Target\n */\nexport interface CodeBuildProjectProps extends TargetBaseProps {\n\n  /**\n   * The role to assume before invoking the target\n   * (i.e., the codebuild) when the given rule is triggered.\n   *\n   * @default - a new role will be created\n   */\n  readonly eventRole?: iam.IRole;\n\n  /**\n   * The event to send to CodeBuild\n   *\n   * This will be the payload for the StartBuild API.\n   *\n   * @default - the entire EventBridge event\n   */\n  readonly event?: events.RuleTargetInput;\n}\n\n/**\n * Start a CodeBuild build when an Amazon EventBridge rule is triggered.\n */\nexport class CodeBuildProject implements events.IRuleTarget {\n  constructor(\n    private readonly project: codebuild.IProject,\n    private readonly props: CodeBuildProjectProps = {},\n  ) {}\n\n  /**\n   * Allows using build projects as event rule targets.\n   */\n  public bind(_rule: events.IRule, _id?: string): events.RuleTargetConfig {\n\n    if (this.props.deadLetterQueue) {\n      addToDeadLetterQueueResourcePolicy(_rule, this.props.deadLetterQueue);\n    }\n\n    return {\n      ...bindBaseTargetConfig(this.props),\n      arn: this.project.projectArn,\n      role: this.props.eventRole || singletonEventRole(this.project, [\n        new iam.PolicyStatement({\n          actions: ['codebuild:StartBuild'],\n          resources: [this.project.projectArn],\n        }),\n      ]),\n      input: this.props.event,\n      targetResource: this.project,\n    };\n  }\n}\n"],
  "mappings": "uNAEA,IAAA,QAAA,iBACA,OAAA,QAAA,UA4BA,sBAA6B,CAC3B,YACmB,QACA,MAA+B,GAAE,CADjC,KAAA,QAAA,QACA,KAAA,MAAA,8JAMZ,KAAK,MAAqB,IAAY,oEAEvC,KAAK,MAAM,iBACb,OAAA,mCAAmC,MAAO,KAAK,MAAM,iBAGhD,IACF,OAAA,qBAAqB,KAAK,OAC7B,IAAK,KAAK,QAAQ,WAClB,KAAM,KAAK,MAAM,WAAa,OAAA,mBAAmB,KAAK,QAAS,CAC7D,GAAI,KAAI,gBAAgB,CACtB,QAAS,CAAC,wBACV,UAAW,CAAC,KAAK,QAAQ,gBAG7B,MAAO,KAAK,MAAM,MAClB,eAAgB,KAAK,UAzB3B,QAAA,iBAAA",
  "names": []
}
